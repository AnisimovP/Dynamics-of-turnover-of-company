Привет! отправляю на проверку код (пока без финального шага по дашборду, скорее всего код придется подправиться)

по поводу витрины. слегка не соглашусь с данными:cnt_transactions — общий объём транзакций по валюте. написано cnt(count скорее всего) по названию имеется ввиду количество транзакций по валюты, но при этом общий объём транзакций это общая сумма денежных операций, проведенных в определенной валюте за определенный период времени.но она не сильно будет отличаться от предыдущего amount_total. Скорее всего avg_transactions_per_account - средний объём транзакций с аккаунта тоже имеется ввиду количество транзакций или все-таки объем транзакций за аккаунт?


Привет! учел все комментарии и замечания. 
По поводу метрик и задания яндекс. Что-то авторы начудили. 
1)amount_total — общая сумма транзакций по валюте в долларах; а в дашборде просят Визуализируйте метрику суммы переводов в разных валютах. Что физически не возможно, потому что мы перевесли все транзакции в долларах. Понятно, что они имели в виду посчитать по разным currency_from но суммарно у нас все равно все долларах.
2)Визуализируйте метрику среднего количества транзакций на пользователя. это вообще не возможно посчитать потому что avg_transactions_per_account — средний объём транзакций с аккаунта; то как они написали это сумма транзакций с аккаунта, а не колличества и в итоге не знаешь где не правильно делать, в витрине или дашборде. Сделал так как у меня сделано в витрине - средний объем (сумма) транзакций
3)по поводу соверщенных транзакций. Понятно, что надо их разделить по статусу Done и Chargeback. Но транзакции невозможно разделить, потому что данные очень грязные. на один Object Id существую 2 разные транзакции к примеру: object id - 00008360-afa6-4d2a-965b-f4e4fe5d049d на него две транзакции на китай и Россию. из-за этого невозможно разделить на то что готово и возвращенно. сделал просто сортировка по Done, но естественно это слегка не правильно.